

<!DOCTYPE html>
<html class="writer-html5" lang="fr" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Referentiel &mdash; Documentation Doc-logiciel 1.0.1</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/translations.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" />
    <link rel="next" title="Guide" href="guide.html" />
    <link rel="prev" title="Welcome to Doc-logiciel’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Doc-logiciel
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Content:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Referentiel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#turn-off-jekyll">Turn Off Jekyll</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-in-ci">Running in CI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ci-config-file">CI Config File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#commit">Commit</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ssh-key">SSH Key</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ssh-keygen">ssh-keygen</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">travis.yml</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="guide.html">Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Doc-logiciel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Referentiel</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/tutoriels.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="referentiel">
<h1>Referentiel<a class="headerlink" href="#referentiel" title="Lien permanent vers ce titre">¶</a></h1>
<p>It’s pretty easy to use <a class="reference external" href="https://pages.github.com/">GitHub Pages</a> to host all of your versioned documentation. Before
starting be sure to go through the <span class="xref std std-ref">tutorial</span> first to make sure you can build your docs locally. You’ll also want
to do the <span class="xref std std-ref">push-all-versions</span> section.</p>
<div class="admonition tip">
<p class="admonition-title">Astuce</p>
<p>You may want to enable GitHub’s <a class="reference external" href="https://help.github.com/articles/about-protected-branches/">protected branches</a>
feature for the gh-pages branch to prevent you or anyone from accidentally deleting the branch from remote.</p>
</div>
<p>This guide assumes:</p>
<ol class="arabic simple">
<li><p>You already have documentation in your master branch and SCVersioning builds it locally. If not you’ll need to use
the <code class="xref std std-option docutils literal notranslate"><span class="pre">--root-ref</span></code> argument.</p></li>
<li><p>You already have your CI configured and running on your repo (this guide uses Travis CI but it should work on any
other).</p></li>
</ol>
<div class="section" id="turn-off-jekyll">
<h2>Turn Off Jekyll<a class="headerlink" href="#turn-off-jekyll" title="Lien permanent vers ce titre">¶</a></h2>
<p>Building on the steps in the <span class="xref std std-ref">tutorial</span> document you’ll want to disable Jekyll because it doesn’t copy over files
and directories <a class="reference external" href="https://github.com/blog/572-bypassing-jekyll-on-github-pages">that start with underscores</a>, which
Sphinx uses.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git checkout gh-pages
git pull origin gh-pages
touch .nojekyll
git add .nojekyll
git commit
git push origin gh-pages
git checkout master  <span class="c1"># Or whatever branch you were in.</span>
</pre></div>
</div>
<p>Then navigate to <a class="reference external" href="https://username.github.io/repo_name/">https://username.github.io/repo_name/</a> and if you used <code class="docutils literal notranslate"><span class="pre">.</span></code> for your <code class="xref std std-option docutils literal notranslate"><span class="pre">REL_DEST</span></code> you should see
your HTML docs there. Otherwise if you used something like <code class="docutils literal notranslate"><span class="pre">html/docs</span></code> you’ll need to navigate to
<a class="reference external" href="https://username.github.io/repo_name/html/docs/">https://username.github.io/repo_name/html/docs/</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Astuce</p>
<p>Old repositories may not have <strong>Enforce HTTPS</strong> enabled for their GitHub Pages. It’s a good idea to enable this
feature. More info: <a class="reference external" href="https://help.github.com/articles/securing-your-github-pages-site-with-https/">https://help.github.com/articles/securing-your-github-pages-site-with-https/</a></p>
</div>
</div>
<div class="section" id="running-in-ci">
<h2>Running in CI<a class="headerlink" href="#running-in-ci" title="Lien permanent vers ce titre">¶</a></h2>
<p>The goal of using GitHub Pages is to have docs automatically update on every new/changed branch/tag. In this example
we’ll be using Travis CI but any CI should work.</p>
<p>Travis won’t be able to push any changes to the gh-pages branch without SSH keys. This section will worry about just
getting Travis to run SCVersioning. It should only fail when trying to push to origin.</p>
<div class="section" id="ci-config-file">
<h3>CI Config File<a class="headerlink" href="#ci-config-file" title="Lien permanent vers ce titre">¶</a></h3>
<p>Edit your CI configuration file (e.g. <a class="reference external" href="https://docs.travis-ci.com/user/customizing-the-build/">.travis.yml</a>) with:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">install</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">pip install sphinxcontrib-versioning</span>
<span class="nt">after_success</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">git config --global user.email &quot;builds@travis-ci.com&quot;</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">git config --global user.name &quot;Travis CI&quot;</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sphinx-versioning push docs gh-pages .</span>
</pre></div>
</div>
<p>The two git config lines are needed to make commits locally to the gh-pages branch (cloned to a temporary directory by
SCVersioning). If you want SCVersioning to delete unrelated files from the gh-pages branch (e.g. deleted branches” HTML
documentation, deleted tags, etc) change the sphinx-versioning command to:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sphinx-versioning -e .gitignore -e .nojekyll -e README.rst push docs gh-pages .
</pre></div>
</div>
<p>This tells SCVersioning to delete all files in gh-pages except those three. More information in <code class="xref std std-option docutils literal notranslate"><span class="pre">--grm-exclude</span></code>.</p>
</div>
<div class="section" id="commit">
<h3>Commit<a class="headerlink" href="#commit" title="Lien permanent vers ce titre">¶</a></h3>
<p>Commit your changes to the CI config file and push. You should see documentation building successfully, but it should
fail when it tries to push since we haven’t given your CI any permission to make changes to the git repository.</p>
</div>
</div>
<div class="section" id="ssh-key">
<h2>SSH Key<a class="headerlink" href="#ssh-key" title="Lien permanent vers ce titre">¶</a></h2>
<p>Now that we know SCVersioning works fine locally and remotely it’s time to unleash it. We’ll be using
<a class="reference external" href="https://developer.github.com/guides/managing-deploy-keys/">Deploy Keys</a> to grant Travis write access to your
repository. At the time of this writing this is the most narrow-scoped authorization method for docs deployment.</p>
<p>To avoid leaking the SSH private key (thereby granting write access to the repo) we’ll be using Travis CI’s
<a class="reference external" href="https://docs.travis-ci.com/user/encrypting-files/">Encrypting Files</a> feature. You’ll need to install the Travis CI
<a class="reference external" href="https://github.com/travis-ci/travis.rb#installation">ruby client</a> for this section.</p>
<div class="section" id="ssh-keygen">
<h3>ssh-keygen<a class="headerlink" href="#ssh-keygen" title="Lien permanent vers ce titre">¶</a></h3>
<p>First we’ll create the SSH key pair.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh-keygen -t rsa -b <span class="m">4096</span> -C <span class="s2">&quot;Travis CI Deploy Key&quot;</span> -N <span class="s2">&quot;&quot;</span> -f docs/key
cat docs/key.pub  <span class="c1"># We&#39;ll be adding this to GitHub&#39;s repo settings page.</span>
travis encrypt-file docs/key docs/key.enc --add after_success  <span class="c1"># Updates .travis.yml</span>
rm docs/key docs/key.pub  <span class="c1"># Don&#39;t need these anymore.</span>
</pre></div>
</div>
<p>We need to give GitHub your SSH <strong>public</strong> key (the one we ran with <code class="docutils literal notranslate"><span class="pre">cat</span></code>). Go to
<a class="reference external" href="https://github.com/username/repo_name/settings/keys">https://github.com/username/repo_name/settings/keys</a> and click « Add deploy key ». The title could be anything (e.g.
« Travis CI Deploy Key »). The key you’re pasting will be one long line and will look something like « ssh-rsa AAAAB3N…==
Travis CI Deploy Key »</p>
<p>Be sure to check <strong>Allow write access</strong>.</p>
</div>
<div class="section" id="id1">
<h3>travis.yml<a class="headerlink" href="#id1" title="Lien permanent vers ce titre">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">travis</span> <span class="pre">encrypt-file</span></code> command should have updated your <code class="docutils literal notranslate"><span class="pre">.travis.yml</span></code> with the openssl command for you. However
we still need to make one more change to the file before committing it. Update .travis.yml to make the after_success
section look like the following. Remember to replace <strong>$encrypted_x_key</strong> and <strong>$encrypted_x_iv</strong> with what you
currently have.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">after_success</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eval &quot;$(ssh-agent -s)&quot;; touch docs/key; chmod 0600 docs/key</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">openssl aes-256-cbc -d -K $encrypted_x_key -iv $encrypted_x_iv &lt; docs/key.enc &gt; docs/key</span>
    <span class="l l-Scalar l-Scalar-Plain">&amp;&amp; ssh-add docs/key</span>  <span class="c1"># Use &amp;&amp; to prevent ssh-add from prompting during pull requests.</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">git config --global user.email &quot;builds@travis-ci.com&quot;</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">git config --global user.name &quot;Travis CI&quot;</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">git remote set-url --push origin &quot;git@github.com:$TRAVIS_REPO_SLUG&quot;</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">export ${!TRAVIS*}</span>  <span class="c1"># Optional, for commit messages.</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sphinx-versioning push docs gh-pages .</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Avertissement</p>
<p>Always conditionally run ssh-add only if openssl succeeds like in the example above. Encrypted environment variables
are not set on Travis CI and probably other CIs during pull requests for security reasons. If you always run ssh-add
(which appears to be what everyone does) all of your pull requests will have failing tests because:</p>
<ol class="arabic simple">
<li><p>Travis CI runs all commands in after_success even if one fails.</p></li>
<li><p>openssl appears to copy « key.enc » to « key » when it fails to decrypt.</p></li>
<li><p>ssh-add will prompt for a passphrase because it thinks the file is encrypted with an SSH passphrase.</p></li>
<li><p>The Travis job will hang, timeout, and fail even if tests pass.</p></li>
</ol>
</div>
<p>Finally commit both <strong>.travis.yml</strong> and the encrypted <strong>docs/key.enc</strong> file. Push and watch Travis update your docs
automatically for you.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="guide.html" class="btn btn-neutral float-right" title="Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to Doc-logiciel’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Aurelien BURET, Nicolas DEGRELLE, Souleymane Diallo.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>